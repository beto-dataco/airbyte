version: "0.29.0"

definitions:
  selector:
    type: RecordSelector
    extractor:
      type: DpathExtractor
      field_path: ["items", "*", "data"]

  requester:
    type: HttpRequester
    url_base: "https://looker.dtcco.io:443/api/4.0"
    http_method: "GET"
    authenticator:
      type: OAuth
      api_token: "{{ config['api_token'] }}"

  retriever:
    type: SimpleRetriever
    record_selector:
      $ref: "#/definitions/selector"
    requester:
      $ref: "#/definitions/requester"
    paginator:
      type: DefaultPaginator
      page_size_option:
        type: "RequestOption"
        inject_into: "request_parameter"
        field_name: "per_page"
      pagination_strategy:
        type: "PageIncrement"
        page_size: 2
        start_from_page: 1
      page_token_option:
        type: "RequestOption"
        inject_into: "request_parameter"
        field_name: "page"

  base_stream:
    type: DeclarativeStream
    retriever:
      $ref: "#/definitions/retriever"

  color_collections_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "color_collections"
      path: "/color_collections"
  connections_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "connections"
      path: "/connections"
  content_metadata_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "content_metadata_id"
    $parameters:
      name: "content_metadata"
      path: "/content_metadata"
  content_metadata_access_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "content_metadata_id"
    $parameters:
      name: "content_metadata_access"
      path: "/content_metadata_access"
  dashboards_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "dashboards"
      path: "/dashboards"
  dashboard_elements_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "dashboard_elements_stream"
      path: "/dashboards/{dashboard_id}/dashboard_elements"
  dashboard_filters_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "dashboard_filters_stream"
      path: "/dashboards/{dashboard_id}/dashboard_filters"
  dashboard_layouts_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "dashboard_layouts_stream"
      path: "/dashboards/{dashboard_id}/dashboard_layouts"
  datagroups_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "datagroups_stream"
      path: "/datagroups"
  folders_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "folders_stream"
      path: "/folders"
  groups_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "groups_stream"
      path: "/groups"
  homepages_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "homepages_stream"
      path: "/primary_homepages_sections"
  integration_hubs_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "integration_hubs_stream"
      path: "/integration_hubs"
  integrations_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "integrations_stream"
      path: "/integrations"
  lookml_dashboards_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "lookml_dashboards_stream"
      path: "/looks"
  lookml_models_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "lookml_models_stream"
      path: "/lookml_models"
  run_look_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "run_look_stream"
      path: "/looks/{look_id}/run/{result_format}"
  project_files_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "project_files_stream"
      path: "/projects/{project_id}/files"
  git_branches_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "git_branches_stream"
      path: "/projects/{project_id}/git_branches"
  query_history_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "query_history_stream"
      path: "/running_queries"
  roles_model_sets_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "roles_model_sets_stream"
      path: "/model_sets"
  roles_permission_sets_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "roles_permission_sets_stream"
      path: "/permission_sets"
  roles_permissions_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "roles_permissions_stream"
      path: "/permissions"
  roles_role_groups_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "roles_role_groups_stream"
      path: "/roles/{role_id}/groups"
  scheduled_plans_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "scheduled_plans_stream"
      path: "/scheduled_plans"
  user_attribute_group_value_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "user_attribute_group_value_stream"
      path: "/users/{user_id}/attribute_values"
  user_login_lockouts_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "user_login_lockouts_stream"
      path: "/user_login_lockouts"
  user_web_login_sessions_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "user_web_login_sessions_stream"
      path: "/users/{user_id}/sessions"
  versions_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "versions_stream"
      path: "/versions"
  workspaces_stream:
    $ref: "#/definitions/base_stream"
    primary_key: "id"
    $parameters:
      name: "workspaces_stream"
      path: "/workspaces"

streams:
  - "#/definitions/call_outcomes_stream"
  - "#/definitions/calls_stream"
  - "#/definitions/collaborations_stream"
  - "#/definitions/contacts_stream"
  - "#/definitions/leads_stream"
  - "#/definitions/lead_conversions_stream"
  - "#/definitions/lead_sources_stream"
  - "#/definitions/lead_unqualified_reasons_stream"
  - "#/definitions/deal_sources_stream"
  - "#/definitions/deal_unqualified_reasons_stream"
  - "#/definitions/deals_stream"
  - "#/definitions/loss_reasons_stream"
  - "#/definitions/notes_stream"
  - "#/definitions/orders_stream"
  - "#/definitions/pipelines_stream"
  - "#/definitions/products_stream"
  - "#/definitions/stages_stream"
  - "#/definitions/tags_stream"
  - "#/definitions/tasks_stream"
  - "#/definitions/text_messages_stream"
  - "#/definitions/users_stream"
  - "#/definitions/visit_outcomes_stream"
  - "#/definitions/visits_stream"

check:
  type: CheckStream
  stream_names:
    - leads

spec:
  type: Spec
  documentation_url: https://docs.airbyte.com/integrations/sources/zendesk-sell
  connection_specification:
    $schema: http://json-schema.org/draft-07/schema#
    title: Source Zendesk Sell Spec
    type: object
    additionalProperties: true
    required:
      - api_token
    properties:
      api_token:
        title: API token
        type: string
        description: "The API token for authenticating to Zendesk Sell"
        examples:
          - "f23yhd630otl94y85a8bf384958473pto95847fd006da49382716or937ruw059"
        airbyte_secret: true
        order: 1